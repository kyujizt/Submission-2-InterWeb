importScripts("https://storage.googleapis.com/workbox-cdn/releases/6.5.4/workbox-sw.js");const{precaching,routing,strategies}=workbox,CACHE_NAME="story-app-v1";precaching.precacheAndRoute([{url:"/",revision:null},{url:"/index.html",revision:null},{url:"/favicon.png",revision:null},{url:"/images/logo.png",revision:null}]),routing.registerRoute((({request:e})=>"image"===e.destination),new strategies.CacheFirst({cacheName:"story-app-images",plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:60,maxAgeSeconds:2592e3})]})),routing.registerRoute((({request:e})=>"script"===e.destination||"style"===e.destination),new strategies.StaleWhileRevalidate({cacheName:"story-app-static"})),routing.registerRoute((({url:e})=>e.pathname.startsWith("/v1/stories")),new strategies.StaleWhileRevalidate({cacheName:"story-app-api",plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:50,maxAgeSeconds:604800})]})),self.addEventListener("fetch",(e=>{e.respondWith(caches.match(e.request).then((t=>t||fetch(e.request).then((t=>caches.open("story-cache").then((i=>(i.put(e.request,t.clone()),t))))))).catch((()=>caches.match("/fallback.json"))))})),self.addEventListener("push",(e=>{let t={title:"Notification",options:{body:"This is a push notification",icon:"/favicon.png",image:"/favicon.png",badge:"/favicon.png"}};e.data&&(t=JSON.parse(e.data.text()));const i=self.registration.showNotification(t.title,t.options);e.waitUntil(i)})),self.addEventListener("notificationclick",(e=>{e.notification.close();const t=e.notification?.data?.url||"/";e.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then((e=>{for(const i of e)if(i.url===t&&"focus"in i)return i.focus();if(clients.openWindow)return clients.openWindow(t)})))}));